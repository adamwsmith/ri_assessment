mathdat=read.csv("psat-math-school Quick Report.csv")
data=mathdat
data=data[-1,]
exclude=numeric()
data[,1]
length(data[,1])
View(data)
data=mathdat
data[,1:2]=as.string(data[,1:2])
data[,1:2]=string(data[,1:2])
data[,1:2]=as.character(data[,1:2])
View(data)
data[,1:2][1]=as.character(data[,1:2][1])
data=mathdat
data[,1:2][1]=as.character(data[,1:2][1])
data[,1]
data[,1][1]
a
mathdat=read.csv("psat-math-school Quick Report.csv")
data=mathdat
data[,1][1]
data[2,1][1]
data=data[-1,]
View(data)
data[,1][1]
data[,1]
data[,1]=as.character(data[,1])
data[,1]
rm(list=ls())
mathdat=read.csv("psat-math-school Quick Report.csv")
colnames(mathdat)=c("dist","school","grade","num_enrolled","pctested","not","partial","meeting","exceed","meetandexceed","avgscalescore")
data=mathdat
data=data[-1,]
data[,1:2][1]=as.character(data[,1:2][1])
data=mathdat
data=data[-1,]
data[,1:2]=as.character(data[,1:2])
data=mathdat
data=data[-1,]
data[,1]=as.character(data[,1])
data[,1]
data[,2]=as.character(data[,2])
data=mathdat
for(r in 1:2){
data[,c]=as.character(data[,c])
}
data=mathdat
data=data[-1,]
for(c in 1:2){
data[,c]=as.character(data[,c])
}
for(c in 3:length(colnames(data))){ #ensure fields are numeric NOT factor
data[,c]=as.numeric(data[,c])
}
data=mathdat
data=data[-1,]
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
View(data)
data[,1]
data[15,2]
data[15,5]
data[15,5][1]
data[15,5][[1]]
data[[15,5]][1]
data[15,5][1]
cleaner=function(data){
data=data[-1,]
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
for(r in 1:length(data[,1])){
if(data[r,4][1]=="*" | data[r,4][1]=="**"){
data[r,4][1]=-1
}
}
}
cleaner(mathdat)
rm(list=ls())
mathdat=read.csv("psat-math-school Quick Report.csv")
colnames(mathdat)=c("dist","school","grade","num_enrolled","pctested","not","partial","meeting","exceed","meetandexceed","avgscalescore")
data=mathdat
data=data[-1,]
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
for(r in 1:length(data[,1])){
if(data[r,4][1]=="*" | data[r,4][1]=="**"){
data[r,4][1]=-1
}
}
data=mathdat
data=data[-1,]
View(data)
exclude=numeric()
for(r in 1:length(data[,1])){
if(data[r,4][1]=="*" | data[r,4][1]=="**"){
exclude=c(exclude,r)
}
}
View(data)
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 1:length(data[,1])){
if(data[r,4][1]=="*" | data[r,4][1]=="**"){
exclude=c(exclude,r)
}
}
data=data[-exclude,]
View(data)
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 1:length(data[,1])){
for(c in 1:length(colnames(data))){
if(data[r,4][1]=="*" | data[r,4][1]=="**"){
exclude=c(exclude,r)
}
}
}
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 1:length(data[,1])){
for(c in 1:length(colnames(data))){
if(data[r,c][1]=="*" | data[r,c][1]=="**"){
exclude=c(exclude,r)
}
}
}
data=mathdat
View(data)
data[10,4][1]
data[10,4]
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 1:length(data[,1])){
for(c in 1:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
}
}
}
View(mathdat)
exclude=numeric()
for(r in 1:length(data[,1])){
for(c in 1:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
next()
}
}
}
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 1:length(data[,1])){
for(c in 1:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
next()
}
}
}
unique(exclude)
data=data[-exclude,]
for(c in 3:length(colnames(data))){ #ensure fields are numeric NOT factor
data[,c]=as.numeric(data[,c])
}
View(data)
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 1:length(data[,1])){
for(c in 1:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
exclude=unique(exclude)
}
}
}
data=data[-exclude,]
View(data)
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 1:length(data[,1])){
for(c in 1:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
exclude=unique(exclude)
}
}
}
data=data[-c(1,exclude),]
View(data)
for(c in 3:length(colnames(data))){ #ensure fields are numeric NOT factor
data[,c]=as.numeric(data[,c])
}
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 1:length(data[,1])){
for(c in 1:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
exclude=unique(exclude)
}
else if(c>2){
data[r,c]=as.numeric(data[r,c])
}
}
}
View(data)
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 1:length(data[,1])){
for(c in 1:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
}
else if(c>=3){
data[r,c]=as.numeric(data[r,c])
}
}
exclude=c(1,unique(exclude))
}
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 1:length(data[,1])){
for(c in 1:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
}
else if(c>=3){
data[r,c]=as.numeric(data[r,c])
}
}
exclude=unique(exclude)
}
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 1:length(data[,1])){
for(c in 1:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
}
else if(p>=3){
data[r,p]=as.numeric(data[r,p])
}
}
exclude=unique(exclude)
}
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
View(data)
exclude=numeric()
View(data)
exclude=numeric()
for(r in 2:length(data[,1])){
for(c in 3:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
}
else if(c>=3){
data[r,c]=as.numeric(data[r,c])
}
}
exclude=unique(exclude)
}
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 2:length(data[,1])){
for(c in 3:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
data[r,c]=as.numeric(data[r,c])
}
}
}
exclude=unique(exclude)
data=data[-c(1,exclude),]
View(data)
cleaner=function(data){
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 2:length(data[,1])){
for(c in 3:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
data[r,c]=as.numeric(data[r,c])
}
}
}
exclude=unique(exclude)
}
cleaner(mathdat)
rm(list=ls())
mathdat=read.csv("psat-math-school Quick Report.csv")
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
cleaner=function(data){
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 2:length(data[,1])){
for(c in 3:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
data[r,c]=as.numeric(data[r,c])
}
}
}
exclude=unique(exclude)
}
cleaner=function(data){
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 2:length(data[,1])){
for(c in 3:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
data[r,c]=as.numeric(data[r,c])
}
}
}
exclude=unique(exclude)
data=data[-c(1,2,exclude),]
return(data)
}
cleaner(mathdat)
rm(list=ls())
mathdat=read.csv("psat-math-school Quick Report.csv")
colnames(mathdat)=c("dist","school","grade","num_enrolled","pctested","not","partial","meeting","exceed","meetandexceed","avgscalescore")
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 2:length(data[,1])){
for(c in 3:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**"){
exclude=c(exclude,r)
data[r,c]=as.numeric(data[r,c])
}
}
}
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
View(data)
length(data[,1])
for(r in 1:length(data[,1])){
for(c in 3:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**" | data[r,c]=="***"){
exclude=c(exclude,r)
} else {
data[r,c]=as.numeric(data[r,c])
}
}
}
View(data)
data=mathdat
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric()
for(r in 1:length(data[,1])){
for(c in 3:length(colnames(data))){
if(data[r,c][1]=="*" | data[r,c][1]=="**" | data[r,c][1]=="***"){
exclude=c(exclude,r)
} else {
data[r,c]=as.numeric(data[r,c][1])
}
}
}
r=15
c=4
data[r,c][1]
data=mathdat
data[r,c][1]
as.numeric(data[r,c][1])
rm(list=ls())
setwd("/Users/spikesmth/Documents/GitHub/ri_assessment")
direct=getwd()
setwd(direct)
psatmath=read.csv("psat-math-school Quick Report.csv")
psatlang=read.csv("psat-ela-school Quick Report.csv")
cleaner=function(data){
for(c in 1:2){ #convert character columns to char
data[,c]=as.character(data[,c])
}
exclude=numeric() #initialize exclusion vector
for(r in 3:length(data[,1])){ #identify rows to add to exclusion vector (rows containing *,**,***)
for(c in 3:length(colnames(data))){
if(data[r,c]=="*" | data[r,c]=="**" | data[r,c]=="***"){
exclude=c(exclude,r)
}
}
}
exclude=unique(exclude) #remove duplicate exclusion terms
data=data[-c(1,exclude),] #eliminate rows from dataframe
for(c in 3:length(colnames(data))){ #convert factor values to char then numeric
data[,c]=as.character(data[,c])
data[,c]=as.numeric(data[,c])
}
clip=numeric() #remove extra frames at the bottom
for(r in 1:length(data[,4])){
if(is.na(data[r,4])){
clip=c(clip,r)
}
}
data=data[-clip,]
colnames(data)=c("dist","school","grade","num_enrolled","pctested","not","partial","meeting","exceed","meetandexceed","avgscalescore")
return(data)
}
mathdat=cleaner(psatmath)
eladat=cleaner(psatlang)
eshdb=read.csv("ri_ass_dat_2018_01.csv")
cleaner2=function(data){
#converting columns from factor to char,numeric,logical
for(c in c(1,3,5,7,11,12,14,16)){
data[,c]=as.character(data[,c])
data[,c]=as.numeric(data[,c])
}
for(c in c(2,4,6,8,9,15)){
data[,c]=as.character(data[,c])
}
for(c in c(10,13)){
data[,c]=as.logical(data[,c])
}
return(data)
}
eshdb_clean=cleaner2(eshdb)
ridata=mathdat
eshdata=eshdb_clean
num_char=12
namematch=function(ridata,eshdata,num_char){
maindf=data.frame()
for(r in 1:length(ridata[,1])){
rowdat=list()
name.source=ridata$school[r] #pick up school name each row
name.source=gsub(" ","",name.source) #kill spaces
name.source=gsub("\\.","",name.source) #kill periods
name.source=tolower(name.source) #make lower case
name.source=substr(name.source,1,num_char) #clip string to length of num_char input var.
for(t in 1:length(eshdata[,1])){
name.target=eshdata$school_name[t] #pick up school name each row
name.target=gsub(" ","",name.target) #kill spaces
name.target=gsub("\\.","",name.target) #kill periods
name.target=tolower(name.target) #make lower case
name.target=substr(name.target,1,num_char) #clip string to length of num_char input var.
if(name.source==name.target){
rowdat=c(ridata[r,],
"frl_percent"=eshdata$frl_percent[t], #percent eligible for lunch subsidy
"stupschool"=(eshdata$num_students[t]/eshdata$num_schools[t]), #average student/school/dist
"teachpschool"=(eshdata$num_teachers[t]/eshdata$num_schools[t]), #average teach/school/dist
"pctc2_spent"=eshdata$pct_c2_spent[t], #percent of C2 budget spent
"bwps"=eshdata$ia_bandwidth_per_student_kbps[t]) #bandwidth per student
}
}
maindf=rbind(maindf,rowdat)
}
maindf=as.data.frame(maindf)
return(maindf)
}
